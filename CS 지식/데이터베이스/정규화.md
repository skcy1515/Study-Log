# 목차
- [정규화의 개념](#정규화의-개념)
  - [이상현상](#이상현상)
    - [삽입 이상](#삽입-이상)
    - [수정 이상](#수정-이상)
    - [삭제 이상](#삭제-이상)
  - [정규화의 필요성](#정규화의-필요성)
- [함수적 종속성](#함수적-종속성)
- [정규화](#정규화)
- [정규형](#정규형)
  - [제1정규형 (1NF)](#제1정규형-(1NF))
    - [1NF 이상의 원인](#1NF-이상의-원인)
# 정규화의 개념
릴레이션 스키마를 잘못 설계할 때의 문제점: 불필요한 데이터 중복이 발생하여, 이상 현상(릴레이션에 대한 데이터 삽입·수정·삭제 연산 수행할 때 발생할 수 있는 부작용) 발생

정규화(normalization): 이상 현상을 제거하면서 릴레이션 스키마를 올바르게 설계해 나가는 과정

## 이상현상
관계형 데이터베이스 스키마가 잘못 설계되었을 때 나타날 수 있는 부작용
- 삽입 이상(insertion anomaly): 투플 삽입(insert)시, 불필요한 데이터를 함께 저장해야만 투플 삽입이 가능한 현상
- 수정 이상(update anomaly, 갱신 이상): 데이터 수정(update)시, 중복된 데이터의 일부만 수정되어 데이터의 불일치 문제가 발생하는 현상
- 삭제 이상(deletion anomaly): 투플 삭제(delete)시, 다른 필요한 정보까지 함께 삭제되는 데이터 손실의 문제

### 삽입 이상
투플 삽입(insert)시, 불필요한 데이터를 함께 저장해야만 투플 삽입이 가능한 현상

예: 
  - 새로운 고객 (아이디 : melon, 이름 : 성원용, 등급:gold) 추가할 때, 불필요한 가짜 이벤트번호 데이터를 함께 저장해야 함

![pixelcut-export](https://github.com/user-attachments/assets/3ac5d21e-1e9d-43fc-979f-206fb9bafd86)

### 수정 이상
데이터 수정(update)시, 중복된 데이터의 일부만 수정되어 데이터의 불일치 문제가 발생하는 현상

예:
  - “apple” 고객 등급을 “gold”에서 “vip”로 변경
  - “apple”고객 등급의 일부 데이터만 수정
  - “apple” 고객의 등급 데이터 불일치 문제 발생

![pixelcut-export (1)](https://github.com/user-attachments/assets/fcf56199-59c2-4c0c-805e-3df5a59b69b9)

### 삭제 이상
투플 삭제(delete)시, 다른 필요한 정보까지 함께 삭제되는 데이터 손실의 문제

예:
  - “orange” 고객이 이벤트 참여 취소
  - 관련 투플 삭제
  - 필요 정보인 “orange”고객의 정보(고객아이디, 고객이름, 등급)까지 함께 삭제되어, 데이터 손실

![pixelcut-export (2)](https://github.com/user-attachments/assets/58b28de8-d2d3-4d4b-bd9c-c445d1f787bd)

## 정규화의 필요성
이상현상이 발생하는 이유: 관련 없는 속성들을 하나의 릴레이션에 모아두고 있기 때문

정규화: 이상 현상이 발생하지 않도록, 릴레이션을 관련 있는 속성들로만 구성하기 위해 릴레이션을 분해하는 과정

함수적 종속성을 판단하여 정규화를 수행함

# 함수적 종속성
X와 Y를 임의의 속성들의 집합이라고 할 때, X의 값이 Y의 값을 유일하게(unique) 결정(X의 값에 대해 반드시 한 개의 Y값이 대응)한다면 “X는 Y를 함수적으로 결정한다”라고 함

X → Y로 표기하고, “Y는 X에 함수적으로 종속된다” 혹은 “X는 Y의 결정자” 혹은 “X는 Y를 결정한다.” 혹은 “Y는 X에의해 결정된다” 라고 함

예: 고객 릴레이션
  - 각 고객아이디 속성 값에 대응되는 고객이름 속성과 등급속성 값이 단 하나 존재함
  - 고객아이디가 고객이름과 등급 결정
  - 고객아이디 : 결정자, 고객이름 : 종속자, 등급 : 종속자

![image](https://github.com/user-attachments/assets/270ea24b-c187-4778-8870-b19fafe97642)

예: 학생수강성적 릴레이션

![image](https://github.com/user-attachments/assets/3422e30d-c93c-4a49-9a36-61395c18dcf9)

![image](https://github.com/user-attachments/assets/40d63d04-027b-45e7-8f01-dc34f421f8c6)

# 정규화
주어진 릴레이션 스키마가 잘못되어 이상현상이 발생하는 릴레이션 스키마를 (함수적 종속성 등의 종속이론을 이용하여) 분해하여, 이상 현상이 발생하지 않는 바람직한 릴레이션 스키마로 만들어 가는 과정

- 무손실 표현
  - 같은 의미의 정보 유지
  - 그러나 더 바람직한 구조
- 데이타의 중복성 감소
- 릴레이션 분해
  - 1개의 릴레이션을 여러 개의 릴레이션으로 표현
  - 릴레이션 각각에 대해 독립적 조작이 가능

## 릴레이션 분해 원칙
- 무손실 조인: 분해된 릴레이션을 다시 조인해도 데이터가 손실되지 않아야 함
- 종속성 유지: 원래 릴레이션의 함수 종속성이 분해된 릴레이션에도 유지되어야 함

# 정규형
릴레이션의 정규화된 정도(등급)
- 이상현상이 있는 릴레이션은 이상현상을 일으키는 함수 종속성의 유형에 따라 등급 구분
- 정규형 차수가 높을 수록 이상현상은 줄어듦

## 제1정규형 (1NF)
모든 속성값이 원자값(atomic value)만으로 된 릴레이션

제 1 정규형은 릴레이션 정의의 일부분을 이루고 있으므로, 관계형 모델의 릴레이션이라면 모두 제 1정규형을 만족한다고 볼 수 있음

삽입, 수정, 삭제 이상이 일어날 수 있음

### 1NF 이상의 원인
기본키에 부분 함수 종속된 속성이 존재

예: 이벤트참여(고객아이디, 이벤트번호, 당첨여부, 등급, 할인율)

![image](https://github.com/user-attachments/assets/c8e32167-f9af-45c5-9c16-4bf09775f756)

![image](https://github.com/user-attachments/assets/a7d02043-7c35-46ef-8737-aacc105ca1a9)

함수 종속 : 
  - 고객아이디 -> 등급 (부분) 
  - 고객아이디 -> 할인율 (부분)
  - 등급 -> 할인율
  - (고객아이디, 이벤트번호) -> 당첨여부 (완전)
  - (고객아이디, 이벤트번호) -> 등급 (완전)
  - (고객아이디, 이벤트번호) -> 할인율 (완전)

#### 부분 함수 종속
부분 함수 종속은 어떤 속성이 기본 키의 일부에 의해 결정되는 경우를 의미

예를 들어, 기본 키가 복합 키 (A, B)로 이루어져 있을 때, 속성 C가 A 또는 B 중 하나에 의해서만 결정되는 경우가 해당된다

#### 완전 함수 종속
완전 함수 종속은 어떤 속성이 기본 키 전체에 의해 결정되는 경우를 의미한다

### 1NF 이상의 해결
릴레이션을 분해 (부분 함수 종속을 제거) -> 2NF

![image](https://github.com/user-attachments/assets/c8d05d27-e2c7-448a-b43b-6d64537a9eda)

-> 릴레이션 분해
  - 고객(고객아이디,등급,할인율)
  - 이벤트참여(고객아이디,이벤트번호,당첨여부)

## 제2정규형 (2NF)
제1정규형 + 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속

기본키가 한 개의 속성으로 이루어진 릴레이션이 제1정규형을 만족하면 제2정규형도 만족함

예:

![image](https://github.com/user-attachments/assets/4fb9712e-46b0-4f5e-8801-92294ee00d4b)

### 2NF에서의 이상 현상
예 (삽입이상):
  - 할인률 1%인 bronze 등급이 새로 생김: “고객아이디”에 가짜값을 넣어야 삽입 가능

![image](https://github.com/user-attachments/assets/81705701-936f-4ac7-925c-d83e0a75cf8a)

예 (수정이상):
  - gold 등급할인율이 15%로변경됨
  - 일부 튜플만 수정: “gold” 등급의 할인율 데이터 불일치 문제 발생

![image](https://github.com/user-attachments/assets/eb08794a-0890-4b93-971d-e4e4d227935b)

예 (삭제이상):
  - banana고객탈퇴
  - vip등급 할인율 정보 삭제됨: 고객 탈퇴와 관련없는 등급, 할인율 데이터까지 손실

![image](https://github.com/user-attachments/assets/812ddd5d-41c4-45bd-8f17-ee4f97e71192)

### 2NF 이상의 원인
기본키가 아닌 속성들이 기본키에 이행적 함수 종속됨

![image](https://github.com/user-attachments/assets/18d7f671-35c2-4c41-996c-5c3ece88e776)

#### 이행적 함수 종속
어떤 속성이 기본 키에 직접적으로 종속되지 않고, 다른 비키(non-prime) 속성을 통해 간접적으로 종속되는 경우를 말한다

![image](https://github.com/user-attachments/assets/1226a949-80b1-4bab-af55-19314df97776)

### 2NF 이상의 해결
릴레이션을 분해 (이행적 함수 종속을 제거) -> 3NF

![image](https://github.com/user-attachments/assets/078c073e-5f45-4d9f-a3be-6ba0829f5d87)

=> 릴레이션 분해
  - 고객등급(등급, 할인율)
  - 고객(고객아이디, 등급)

## 제3정규형 (3NF)
제1정규형 + 제2정규형 + 기본키가 아닌 모든 속성들이 기본키에 이행적 함수 종속되지 않음

예: 
- 강좌신청 (고객아이디, 인터넷강좌, 담당강사번호)
  - 후보키 : (고객아이디, 인터넷강좌), (고객아이디, 담당강사번호)
  - 기본키 : (고객아이디, 인터넷강좌)
  - 함수종속 : (고객아이디, 인터넷강좌)->담당강사번호, 담당강사번호 ->인터넷강좌

![image](https://github.com/user-attachments/assets/aeb2b165-0782-4b4c-9684-85f528601c79)

### 3NF에서의 이상 현상
예 (삽입이상):
  - 신규로 P005 강사가 중급토익 담당하게 됨: “고객아이디”에 가짜값을 넣어야 삽입 가능

![image](https://github.com/user-attachments/assets/c6e82e22-ca64-4950-bfde-fdda38acc568)

예 (수정이상):
  - P004 강사의 강의가 중급토익으로 변경
  - 일부 튜플만수정: “P004” 강사의 인터넷강좌 데이터 불일치 문제 발생

![image](https://github.com/user-attachments/assets/ea7f8cbd-d9ca-4d90-82ae-f06e82f69477)

예 (삭제이상):
  - banana 고객이 강좌 신청 취소
  - P002 강사 정보도 삭제됨: 고객의 강좌 취소와 관련없는 담당강사번호 데이터까지손실

![image](https://github.com/user-attachments/assets/2f83d2d6-5452-496c-aa58-f1b0182e5e58)

### 3NF에서의 이상 원인
